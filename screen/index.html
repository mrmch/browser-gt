<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>BbBM - Browser based Bomber Man</title>
        <style>
            #container {
                background: #000;
                color: white;
            }
        </style>
    </head>
    <body>
        <div id="container"></div>
        <div id="controls">
            <ul>
                <li>PAUSE_ANIMATION <input type="checkbox" id="ctrl_pause_animation" /></li>
            </ul>
        </div>
    </body>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    <script src="/socket.io/socket.io.js"></script>

    <script src="/screen/games/browser-bomber/js/crafty-min.js"></script>
    <script src="/screen/games/browser-bomber/js/components/crafty-debug-bar-release.js"></script>
    <script src="/screen/games/browser-bomber/js/game.js"></script>

    <script type="text/javascript">
        /**
         * Control variables
         */

        var container = $('#container'),
            screen_id = Math.round(Math.random() * 1000000000),
            controllers = [],
            camera, controls, scene, renderer, light,
            container, stats,
            keyboard,
            microphysics,
            loader,
            
            MARGIN = 100,
            SCREEN_WIDTH = window.innerWidth * .90,
            SCREEN_HEIGHT = window.innerHeight * .90,
            FLOOR = -250,
            
            PAUSE_ANIMATION = false,
            
            socket = io.connect('http://127.0.0.1:8080');

        $(document).ready(function() {
            if (GAME) {
                console.log('Starting game ...');
                GAME.init(window, SCREEN_WIDTH, SCREEN_HEIGHT);
                GAME.start();
            }

            if (PAUSE_ANIMATION) {
                $('#ctrl_pause_animation').attr('checked', 'checked');
            } else {
                $('#ctrl_pause_animation').attr('checked', null);
            }

            $('#ctrl_pause_animation').click(function(){
              PAUSE_ANIMATION = !PAUSE_ANIMATION;
            });
        });
        
          socket.on('updated controller list', function(updated_nodes) {
            // new controller joined the game
            controllers = updated_nodes;
          });

          socket.on('connect', function() {
            // announce this screen to the server
            socket.emit('set screen_id', screen_id);
          });

          socket.on('new action', function(o) {
            // controller performed an action
            // o[0]: controller id
            // o[1]: action object
            GAME.controller_action(o[0], o[1]);
          });

          socket.on('disconnect', function() {
            // connection error handling
          });
    </script>
</html>

